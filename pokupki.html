<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />

  <!-- –ò–ö–û–ù–ö–ò -->
  <link rel="icon" href="icon.png" type="image/png">
  <link rel="apple-touch-icon" href="icon.png">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <title>–ü–æ–∫—É–ø–∫–∏</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 0;
      background: #f4f4f4;
      color: #222;
    }

    .app {
      max-width: 480px;
      margin: 0 auto;
      min-height: 100vh;
      background: #ffffff;
      display: flex;
      flex-direction: column;
    }

    header {
      padding: 16px;
      background: #4a90e2;
      color: white;
    }

    header h1 {
      margin: 0;
      font-size: 20px;
    }

    header p {
      margin: 4px 0 0;
      font-size: 13px;
      opacity: 0.9;
    }

    .input-block {
      padding: 12px 16px;
      border-bottom: 1px solid #eee;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .row {
      display: flex;
      gap: 8px;
    }

    input[type="text"] {
      flex: 1;
      padding: 8px 10px;
      font-size: 16px;
      border-radius: 8px;
      border: 1px solid #ccc;
      outline: none;
    }

    input[type="text"]:focus {
      border-color: #4a90e2;
    }

    button {
      border-radius: 8px;
      border: none;
      padding: 8px 12px;
      font-size: 14px;
      cursor: pointer;
      white-space: nowrap;
    }

    .btn-add {
      background: #4a90e2;
      color: white;
    }

    .btn-add:disabled {
      opacity: 0.5;
      cursor: default;
    }

    .hint {
      font-size: 12px;
      color: #666;
      padding: 0 4px;
    }

    .quick-items {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 4px;
    }

    .quick-btn {
      font-size: 12px;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid #dde;
      background: #f5f7ff;
      color: #334;
    }

    .quick-btn:hover {
      background: #e4e8ff;
    }

    .list {
      flex: 1;
      overflow-y: auto;
      padding: 8px 0 16px;
    }

    ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    li {
      display: flex;
      align-items: center;
      padding: 8px 16px;
      border-bottom: 1px solid #eee;
      gap: 10px;
    }

    li .name {
      flex: 1;
      font-size: 16px;
    }

    li.bought .name {
      text-decoration: line-through;
      color: #999;
    }

    .checkbox {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid #4a90e2;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 13px;
      cursor: pointer;
      flex-shrink: 0;
    }

    .checkbox.checked {
      background: #4a90e2;
      color: white;
    }

    .btn-delete {
      background: transparent;
      color: #ccc;
      font-size: 18px;
      padding: 4px 6px;
    }

    .btn-delete:hover {
      color: #999;
    }

    .footer-buttons {
      padding: 8px 16px 12px;
      border-top: 1px solid #eee;
      display: flex;
      gap: 8px;
      background: #fafafa;
    }

    .btn-clear-bought {
      background: #f8d7da;
      color: #721c24;
    }

    .btn-clear-all {
      background: #e2e3e5;
      color: #383d41;
    }
  </style>
</head>
<body>
<div class="app">
  <header>
    <h1>–°–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫</h1>
    <p>–î–æ–±–∞–≤–ª—è–π –ø—Ä–æ–¥—É–∫—Ç—ã –≤—Ä—É—á–Ω—É—é –∏–ª–∏ –≥–æ–ª–æ—Å–æ–º ‚Äî —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É üé§ –Ω–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ.</p>
  </header>

  <div class="input-block">
    <div class="row">
      <input id="item-input" type="text" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –º–æ–ª–æ–∫–æ —Ö–ª–µ–± –∫–∞—Ä—Ç–æ—à–∫–∞" />
      <button id="add-btn" class="btn-add" disabled>–î–æ–±–∞–≤–∏—Ç—å</button>
    </div>

    <div class="hint">
      üëâ –î–ª—è –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É üé§ –Ω–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    </div>

    <div class="quick-items" id="quick-items">
      <!-- –ö–Ω–æ–ø–∫–∏ –±—ã—Å—Ç—Ä—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –∏–∑ JS -->
    </div>
  </div>

  <div class="list">
    <ul id="items-list"></ul>
  </div>

  <div class="footer-buttons">
    <button id="clear-bought-btn" class="btn-clear-bought">–û—á–∏—Å—Ç–∏—Ç—å –∫—É–ø–ª–µ–Ω–Ω—ã–µ</button>
    <button id="clear-all-btn" class="btn-clear-all">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë</button>
  </div>
</div>

<script>
  const STORAGE_KEY = 'pokupki-items-v1';
  let items = [];

  // –ù–µ–±–æ–ª—å—à–æ–π "—É–º–Ω—ã–π" —Å–ø–∏—Å–æ–∫ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
  const QUICK_ITEMS = [
    '–ú–æ–ª–æ–∫–æ',
    '–•–ª–µ–±',
    '–Ø–π—Ü–∞',
    '–ö–∞—Ä—Ç–æ—à–∫–∞',
    '–ö—É—Ä–∏–Ω–æ–µ —Ñ–∏–ª–µ',
    '–ú–∞—Å–ª–æ',
    '–°—ã—Ä',
    '–ü–æ–º–∏–¥–æ—Ä—ã'
  ];

  function loadItems() {
    try {
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw) {
        items = [];
        return;
      }
      items = JSON.parse(raw);
      if (!Array.isArray(items)) items = [];
    } catch (e) {
      items = [];
    }
  }

  function saveItems() {
    try {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(items));
    } catch (e) {}
  }

  // –†–∞–∑–±–∏–≤–∞–µ–º —Å—Ç—Ä–æ–∫—É –Ω–∞ —Ç–æ–≤–∞—Ä—ã
  function splitToItems(text) {
    if (!text) return [];

    let normalized = text.toLowerCase();

    // —É–±–∏—Ä–∞–µ–º —Ç–æ—á–∫–∏/–∑–Ω–∞–∫–∏, —á—Ç–æ–±—ã "–º—É–∫–∞." —Å—Ç–∞–ª–æ "–º—É–∫–∞"
    normalized = normalized.replace(/[.!?]/g, ' ');

    normalized = normalized
      .replace(/–Ω–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞/g, '\n')
      .replace(/—Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–æ–∫–∞/g, '\n')
      .replace(/—Å–ª–µ–¥—É—é—â–∏–π –ø—É–Ω–∫—Ç/g, '\n')
      .replace(/—Å–ª–µ–¥—É—é—â–∏–π/g, '\n')
      .replace(/enter/g, '\n');

    // —Å–Ω–∞—á–∞–ª–∞ ‚Äî –ø–æ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º
    let parts = normalized
      .split(/[,;\n]/)
      .map(p => p.trim())
      .filter(p => p.length > 0);

    // –µ—Å–ª–∏ –ø–æ–ª—É—á–∏–ª–æ—Å—å –º–∞–ª–æ ‚Äî –ø–æ —Å–ª–æ–≤–∞–º
    if (parts.length <= 1) {
      parts = normalized
        .split(/\s+/)
        .map(p => p.trim())
        .filter(p => p.length > 0);
    }

    return parts;
  }

  function addItemsFromText(text) {
    const parts = splitToItems(text);
    if (parts.length === 0) return;

    for (const name of parts) {
      items.push({
        id: Date.now().toString() + Math.random().toString(16).slice(2),
        name,
        bought: false
      });
    }
    saveItems();
    renderList();
  }

  function addSingleItem(name) {
    const clean = (name || '').trim();
    if (!clean) return;
    items.push({
      id: Date.now().toString() + Math.random().toString(16).slice(2),
      name: clean,
      bought: false
    });
    saveItems();
    renderList();
  }

  function toggleItem(id) {
    items = items.map(item =>
      item.id === id ? { ...item, bought: !item.bought } : item
    );
    saveItems();
    renderList();
  }

  function deleteItem(id) {
    items = items.filter(item => item.id !== id);
    saveItems();
    renderList();
  }

  function clearBought() {
    items = items.filter(item => !item.bought);
    saveItems();
    renderList();
  }

  function clearAll() {
    if (confirm('–¢–æ—á–Ω–æ —É–¥–∞–ª–∏—Ç—å –≤–µ—Å—å —Å–ø–∏—Å–æ–∫?')) {
      items = [];
      saveItems();
      renderList();
    }
  }

  function renderList() {
    const listEl = document.getElementById('items-list');
    listEl.innerHTML = '';

    if (items.length === 0) {
      const li = document.createElement('li');
      li.innerHTML = '<span class="name" style="color:#999;">–°–ø–∏—Å–æ–∫ –ø—É—Å—Ç</span>';
      listEl.appendChild(li);
      return;
    }

    items.forEach(item => {
      const li = document.createElement('li');
      if (item.bought) li.classList.add('bought');

      const checkbox = document.createElement('div');
      checkbox.className = 'checkbox' + (item.bought ? ' checked' : '');
      checkbox.innerHTML = item.bought ? '‚úì' : '';
      checkbox.addEventListener('click', () => toggleItem(item.id));

      const nameSpan = document.createElement('span');
      nameSpan.className = 'name';
      nameSpan.textContent = item.name;
      nameSpan.addEventListener('click', () => toggleItem(item.id));

      const delBtn = document.createElement('button');
      delBtn.className = 'btn-delete';
      delBtn.innerHTML = '‚úï';
      delBtn.addEventListener('click', () => deleteItem(item.id));

      li.appendChild(checkbox);
      li.appendChild(nameSpan);
      li.appendChild(delBtn);
      listEl.appendChild(li);
    });
  }

  function renderQuickItems() {
    const container = document.getElementById('quick-items');
    container.innerHTML = '';
    QUICK_ITEMS.forEach(name => {
      const btn = document.createElement('button');
      btn.className = 'quick-btn';
      btn.textContent = name;
      btn.addEventListener('click', () => addSingleItem(name));
      container.appendChild(btn);
    });
  }

  // –°—Ç–∞—Ä—Ç
  window.addEventListener('DOMContentLoaded', () => {
    const input = document.getElementById('item-input');
    const addBtn = document.getElementById('add-btn');

    loadItems();
    renderList();
    renderQuickItems();

    function updateAddButtonState() {
      addBtn.disabled = input.value.trim().length === 0;
    }

    input.addEventListener('input', updateAddButtonState);

    input.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        e.preventDefault();
        if (!addBtn.disabled) {
          addItemsFromText(input.value);
          input.value = '';
          updateAddButtonState();
        }
      }
    });

    addBtn.addEventListener('click', () => {
      addItemsFromText(input.value);
      input.value = '';
      updateAddButtonState();
    });

    document.getElementById('clear-bought-btn')
      .addEventListener('click', clearBought);

    document.getElementById('clear-all-btn')
      .addEventListener('click', clearAll);
  });
</script>
</body>
</html>
